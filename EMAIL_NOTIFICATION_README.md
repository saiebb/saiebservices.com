# نظام إشعارات الإيميل لطلبات الخدمات

## الوصف
تم إضافة نظام إشعارات تلقائي بالإيميل يرسل إشعاراً إلى `mostaql.dev@gmail.com` عند كل طلب خدمة جديد من الموقع.

## الملفات المضافة/المعدلة

### 1. الملفات الجديدة:
- `action/send_email_notification.php` - ملف إرسال الإشعارات
- `config/email_config.php` - إعدادات الإيميل
- `test_email.php` - ملف اختبار النظام

### 2. الملفات المعدلة:
- `action/savereq.php` - تم إضافة إرسال الإشعار عند حفظ الطلب

## كيفية العمل

1. **عند الضغط على زر "احصل على الخدمة":**
   - يفتح نموذج طلب الخدمة
   - يدخل العميل بياناته
   - عند الضغط على "سجل الطلب"

2. **معالجة الطلب:**
   - يتم حفظ الطلب في قاعدة البيانات
   - يتم جلب بيانات الخدمة المطلوبة
   - يتم إرسال إشعار بالإيميل تلقائياً

3. **محتوى الإشعار:**
   - معلومات الخدمة (الاسم، النوع، المعرف)
   - معلومات العميل (الاسم، الإيميل، الجوال، الوقت المفضل)
   - تاريخ ووقت الطلب
   - حالة الموافقة على آراء Google

## الإعدادات

### إعدادات الإيميل الأساسية:
```php
// في ملف config/email_config.php
define('NOTIFICATION_EMAIL', 'mostaql.dev@gmail.com');
define('EMAIL_FROM_ADDRESS', 'noreply@saiebservices.com');
define('EMAIL_FROM_NAME', 'نظام صيب للخدمات');
```

## اختبار النظام

1. **اختبار تلقائي:**
   - قم بزيارة أي صفحة خدمة
   - اضغط على "احصل على الخدمة"
   - املأ النموذج واضغط "سجل الطلب"

2. **اختبار يدوي:**
   - قم بزيارة `test_email.php`
   - سيتم إرسال إيميل تجريبي

## ملفات السجل

يتم إنشاء ملفات سجل تلقائياً:
- `email_notifications.log` - سجل محاولات إرسال الإيميل
- `service_requests.log` - سجل طلبات الخدمات
- `email_errors.log` - سجل أخطاء الإيميل

## متطلبات الخادم

1. **PHP Mail Function:** يجب أن تكون متاحة
2. **SMTP Settings:** يجب تكوينها في php.ini أو استخدام خدمة إيميل خارجية

### إعدادات XAMPP المحلية:
```ini
[mail function]
SMTP = smtp.gmail.com
smtp_port = 587
sendmail_from = your-email@gmail.com
```

## الأمان

- جميع البيانات يتم تنظيفها قبل الإرسال
- استخدام `htmlspecialchars()` لمنع XSS
- تسجيل جميع المحاولات في ملفات السجل

## استكشاف الأخطاء

### إذا لم يتم إرسال الإيميل:
1. تحقق من ملف `email_errors.log`
2. تحقق من إعدادات PHP mail
3. تحقق من إعدادات الخادم
4. استخدم `test_email.php` للاختبار

### رسائل الخطأ الشائعة:
- "Mail function not available" - دالة mail غير متاحة
- "SMTP connection failed" - فشل الاتصال بخادم SMTP
- "Invalid email address" - عنوان إيميل غير صحيح

## التطوير المستقبلي

يمكن إضافة:
- استخدام PHPMailer للمزيد من الخيارات
- قوالب إيميل متعددة
- إرسال إيميل تأكيد للعميل
- إشعارات SMS
- لوحة تحكم لإدارة الإشعارات

## الدعم

في حالة وجود مشاكل:
1. تحقق من ملفات السجل
2. استخدم ملف الاختبار
3. تحقق من إعدادات الخادم
4. راجع هذا الدليل

---
**تاريخ الإنشاء:** $(date)
**الإصدار:** 1.0