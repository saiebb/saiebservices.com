# تحديث نظام Slug URLs - SAIEB Services

## نظرة عامة
هذا الدليل يوضح كيفية تحديث نظام الروابط الصديقة لمحركات البحث (SEO-friendly URLs) في موقع SAIEB Services.

## ⚠️ تحذير هام
**قبل البدء، تأكد من أخذ نسخة احتياطية كاملة من قاعدة البيانات!**

## خطوات التنفيذ

### 1. إضافة عمود ar_slug إلى قاعدة البيانات
```sql
-- تشغيل محتوى ملف add_slug_column.sql
ALTER TABLE `sa_articles` ADD COLUMN `ar_slug` VARCHAR(255) NULL AFTER `ar_title`;
ALTER TABLE `sa_articles` ADD INDEX `idx_ar_slug` (`ar_slug`);
ALTER TABLE `sa_articles` ADD INDEX `idx_slug_status` (`ar_slug`, `ar_status`);
```

### 2. تشغيل سكربت التحديث
1. افتح المتصفح واذهب إلى: `https://saiebservices.com/update_slugs.php`
2. اتبع التعليمات على الشاشة
3. انتظر حتى اكتمال العملية

### 3. التحقق من النتائج
- تحقق من أن جميع المقالات تحتوي على slugs
- اختبر الروابط الجديدة
- تأكد من عمل إعادة التوجيه بشكل صحيح

### 4. حذف ملفات التحديث (للأمان)
بعد اكتمال التحديث بنجاح، احذف الملفات التالية:
- `update_slugs.php`
- `delete_update_script.php`
- `slug_functions.php`
- `add_slug_column.sql`
- `update_slugs.lock`

## الملفات المضافة/المحدثة

### ملفات جديدة:
- `add_slug_column.sql` - سكربت SQL لإضافة العمود
- `slug_functions.php` - وظائف إنشاء الـ slugs
- `update_slugs.php` - السكربت الرئيسي للتحديث
- `delete_update_script.php` - سكربت حذف الملفات

### ملفات محدثة:
- `action/seo_url.php` - تحديث دالة getBlogUrl()

## كيفية عمل النظام الجديد

### قبل التحديث:
```
/blog/article-title-123 → blog-single.php?id=123
```
الـ slug يتم إنشاؤه ديناميكياً من العنوان في كل مرة

### بعد التحديث:
```
/blog/saved-slug-123 → blog-single.php?id=123
```
الـ slug محفوظ في قاعدة البيانات ولا يتغير

## المزايا الجديدة

1. **ثبات الروابط**: الروابط لا تتغير حتى لو تم تعديل العنوان
2. **أداء أفضل**: لا حاجة لإنشاء slug في كل مرة
3. **SEO محسن**: روابط ثابتة ومناسبة لمحركات البحث
4. **إدارة أفضل**: يمكن تخصيص الـ slug لكل مقال

## استكشاف الأخطاء

### خطأ: "عمود ar_slug غير موجود"
**الحل**: تشغيل ملف `add_slug_column.sql` في قاعدة البيانات

### خطأ: "فشل الاتصال بقاعدة البيانات"
**الحل**: التحقق من إعدادات قاعدة البيانات في `config/database.php`

### خطأ: "تم تشغيل السكربت مسبقاً"
**الحل**: حذف ملف `update_slugs.lock` إذا كنت تريد إعادة التشغيل

## ملاحظات مهمة

- السكربت يعمل لمرة واحدة فقط لحماية البيانات
- يتم تخطي المقالات التي لها عناوين فارغة
- الـ slugs المكررة يتم إضافة رقم لها تلقائياً
- النظام متوافق مع الكود الحالي

## الدعم
في حالة وجود أي مشاكل، يرجى مراجعة هذا الدليل أو الاتصال بفريق التطوير.

---
**تاريخ الإنشاء**: ديسمبر 2024  
**الإصدار**: 1.0  
**المطور**: SAIEB Services Development Team